<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Tan Duc Mai">
    <meta name="description" content="https://tanducmai.com">
    <meta name="keywords" content="blog,developer,personal">

    <meta property="og:site_name" content="Tan Duc Mai">
    <meta property="og:title" content="
  Database - SQL - Control Statements - Tan Duc Mai
">
    <meta property="og:description" content="Database - SQL - Control Statements">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tanducmai.com/blog/database/sql/database-sql-control-statements/">
    <meta property="og:image" content="https://tanducmai.com/images/database/blog/sql/control-statements/if-else.jpg">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="https://tanducmai.com/blog/database/sql/database-sql-control-statements/">
    <meta name="twitter:image" content="https://tanducmai.com/images/database/blog/sql/control-statements/if-else.jpg">

    <base href="https://tanducmai.com/blog/database/sql/database-sql-control-statements/">
    <title>
  Database - SQL - Control Statements - Tan Duc Mai
</title>

    <link rel="canonical" href="https://tanducmai.com/blog/database/sql/database-sql-control-statements/">
    
    <link  rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700">
    <link rel="stylesheet" href="/css/normalize.min.css">
    <link rel="stylesheet" href="/css/style.min.css">

    

    

    <link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

    
      <link rel="alternate" href="https://tanducmai.com/index.xml" type="application/rss+xml" title="Tan Duc Mai">
      <link href="https://tanducmai.com/index.xml" rel="feed" type="application/rss+xml" title="Tan Duc Mai" />
    

    <meta name="generator" content="Hugo 0.68.3" />
  </head>

  <body class="">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">Tan Duc Mai</a>
    <input type="checkbox" id="menu-control"/>
    <label class="menu-mobile  float-right " for="menu-control">
      <span class="btn-mobile  float-right ">&#9776;</span>
      <ul class="navigation-list">
        
          
            <li class="navigation-item  align-center ">
              <a class="navigation-link" href="https://tanducmai.com/about">About</a>
            </li>
          
            <li class="navigation-item  align-center ">
              <a class="navigation-link" href="https://tanducmai.com/blog">Blog</a>
            </li>
          
            <li class="navigation-item  align-center ">
              <a class="navigation-link" href="https://tanducmai.com/project">Portfolio</a>
            </li>
          
            <li class="navigation-item  align-center ">
              <a class="navigation-link" href="https://tanducmai.com/glossary">Glossary</a>
            </li>
          
            <li class="navigation-item  align-center ">
              <a class="navigation-link" href="https://tanducmai.com/contact">Contact</a>
            </li>
          
        
        
          
          
          
            <li class= " mobile-menu-lang-separator-centered ">
              <hr />
            </li>
          
          
            
          
            
              
                
                  <li class="multilingual-separator">
                    <p>|</p>
                  </li>
                
                
              
              <li class="navigation-item  align-center ">
                <a href="https://tanducmai.com/ja/">Japanese</a>
              </li>
            
          
        
      </ul>
    </label>
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1>Database - SQL - Control Statements</h1>
    </header>

    <h3 id="table-of-contents">Table of Contents</h3>
<ol>
<li><a href="#why-control-statements">Why Control Statements?</a></li>
<li><a href="#if-else-statements">IF - ELSE Statements</a></li>
<li><a href="#case-statement">CASE Statement</a></li>
</ol>
<p><img src="/images/database/blog/sql/control-statements/if-else.jpg" alt="IF&hellip;ELSEStatements"></p>
<p>Image Source: <em><a href="https://www.tech-recipes.com/database/how-to-use-if-else-statement-in-sql-server/">Tech
Recipes</a></em></p>
<h3 id="why-control-statement">Why control statement</h3>
<p>Control statements allow actions to happen depending on a condition.</p>
<ul>
<li>The action may involve setting a value.</li>
<li>The action may involve running a different query.</li>
</ul>
<h3 id="if---else-statements"><code>IF</code> - <code>ELSE</code> statements</h3>
<h5 id="syntax">Syntax</h5>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">IF</span> <span class="n">boolean_expression</span>
     <span class="err">{</span> <span class="n">sql_statement</span> <span class="o">|</span> <span class="n">statement_block</span> <span class="err">}</span>
<span class="p">[</span> <span class="k">ELSE</span>
     <span class="err">{</span> <span class="n">sql_statement</span> <span class="o">|</span> <span class="n">statement_block</span> <span class="err">}</span> <span class="p">]</span>
</code></pre></div><h5 id="arguments">Arguments</h5>
<ol>
<li><strong>boolean_expression</strong></li>
</ol>
<ul>
<li>Is an expression that returns TRUE or FALSE. If the Boolean expression
contains a SELECT statement, the SELECT statement must be enclosed in
parentheses.</li>
</ul>
<ol start="2">
<li><strong>{ sql_statement | statement_block }</strong></li>
</ol>
<ul>
<li>Is any Transact-SQL statement or statement grouping as defined by
using a statement block. Unless a statement block is used, the IF or
ELSE condition can affect the performance of only one Transact-SQL
statement.</li>
</ul>
<p>To define a statement block, use the control-of-flow keywords BEGIN and END.</p>
<p>🔗
<em><a href="https://docs.microsoft.com/en-us/sql/t-sql/language-elements/if-else-transact-sql?view=sql-server-ver15">Microsoft</a></em></p>
<h5 id="example">Example</h5>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">IF</span> <span class="n">DATENAME</span> <span class="p">(</span><span class="n">dw</span><span class="p">,</span> <span class="mi">2002</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">03</span><span class="p">)</span> <span class="k">IN</span> <span class="p">(</span><span class="n">N</span><span class="s1">&#39;Saturday&#39;</span><span class="p">,</span> <span class="n">N</span><span class="s1">&#39;Sunday&#39;</span><span class="p">)</span>
    <span class="k">SELECT</span> <span class="s1">&#39;Weekend&#39;</span> <span class="k">AS</span> <span class="k">result</span><span class="p">;</span>
<span class="k">ELSE</span>
    <span class="k">SELECT</span> <span class="s1">&#39;Weekday&#39;</span> <span class="k">AS</span> <span class="k">result</span><span class="p">;</span>
</code></pre></div><p>Result:</p>
<table>
<thead>
<tr>
<th align="center">result</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Weekday</td>
</tr>
</tbody>
</table>
<h3 id="case-statement"><code>CASE</code> statement</h3>
<p>This statement is akin to IF&hellip;ELSE but can be used within a query to
change a particular value.</p>
<h4 id="syntax-1">Syntax</h4>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">CASE</span> <span class="n">input_expression</span>
    <span class="k">WHEN</span> <span class="n">when_expression</span> <span class="k">THEN</span> <span class="n">result_expression</span> <span class="p">[</span> <span class="p">...</span><span class="n">n</span> <span class="p">]</span>
    <span class="p">[</span> <span class="k">ELSE</span> <span class="n">else_result_expression</span> <span class="p">]</span>
<span class="k">END</span>
</code></pre></div><h5 id="arguments-1">Arguments</h5>
<ol>
<li><strong>input_expression</strong></li>
</ol>
<ul>
<li>The expression evaluated when the simple CASE format is used.
input_expression is any valid expression.</li>
</ul>
<ol start="2">
<li><strong>WHEN when_expression</strong></li>
</ol>
<ul>
<li>A simple expression to which input_expression is compared when the
simple CASE format is used. when_expression is any valid expression.
The data types of input_expression and each when_expression must be
the same or must be an implicit conversion.</li>
</ul>
<ol start="3">
<li><strong>THEN result_expression</strong></li>
</ol>
<ul>
<li>The expression returned when input_expression equals when_expression
evaluates to TRUE, or Boolean_expression evaluates to TRUE. result
expression is any valid expression.</li>
</ul>
<ol start="4">
<li><strong>ELSE else_result_expression</strong></li>
</ol>
<ul>
<li>The expression returned if no comparison operation evaluates to TRUE.
If this argument is omitted and no comparison operation evaluates to
TRUE, CASE returns NULL. else_result_expression is any valid
expression. The data types of else_result_expression and any
result_expression must be the same or must be an implicit conversion.</li>
</ul>
<ol start="5">
<li><strong>WHEN Boolean_expression</strong></li>
</ol>
<ul>
<li>The Boolean expression evaluated when using the searched CASE format.
Boolean_expression is any valid Boolean expression.</li>
</ul>
<p>🔗
<em><a href="https://docs.microsoft.com/en-us/sql/t-sql/language-elements/case-transact-sql?view=sql-server-ver15">Microsoft</a></em></p>
<h5 id="example-1">Example</h5>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span>
    <span class="n">FirstName</span><span class="p">,</span>
    <span class="n">Surname</span><span class="p">,</span>
    <span class="n">Salary</span><span class="p">,</span>
    <span class="p">(</span>
    <span class="k">CASE</span>
        <span class="k">WHEN</span> <span class="p">(</span><span class="n">E</span><span class="p">.</span><span class="n">Salary</span> <span class="o">&gt;</span> <span class="mi">75</span><span class="p">)</span> <span class="k">THEN</span> <span class="s1">&#39;Over Paid&#39;</span>
        <span class="k">WHEN</span> <span class="p">(</span><span class="n">E</span><span class="p">.</span><span class="n">Salary</span> <span class="o">&lt;=</span> <span class="mi">40</span><span class="p">)</span> <span class="k">THEN</span> <span class="s1">&#39;Under Paid&#39;</span>
        <span class="k">ELSE</span> <span class="s1">&#39;Adequately Paid&#39;</span>
    <span class="k">END</span>
    <span class="p">)</span> <span class="k">AS</span> <span class="n">PayConclusion</span>
<span class="k">FROM</span> <span class="n">Employee</span> <span class="k">AS</span> <span class="n">E</span>
</code></pre></div><ul>
<li>The CASE statement returns a single column called “PayConclusion” with
value that depends on the employee salary.</li>
</ul>
<p>Sample result:</p>
<p><img src="/images/database/blog/sql/control-statements/case-when-example.png" alt="CASE statementexample"></p>

  </article>
</section>


      </div>
      
    </main>

    

  <script src="/js/app.js"></script>
  
  </body>
</html>
