<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Tan Duc Mai">
    <meta name="description" content="https://tanducmai.com">
    <meta name="keywords" content="blog,developer,personal">

    <meta property="og:site_name" content="Tan Duc Mai">
    <meta property="og:title" content="
  Database - SQL - Table Joins - Tan Duc Mai
">
    <meta property="og:description" content="Database - SQL - Table Joins">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tanducmai.com/posts/database-sql-table-joins/">
    <meta property="og:image" content="https://tanducmai.comimages/database-sql-table-joins/summary.png) ">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="https://tanducmai.com/posts/database-sql-table-joins/">
    <meta name="twitter:image" content="https://tanducmai.comimages/database-sql-table-joins/summary.png) ">

    <base href="https://tanducmai.com/posts/database-sql-table-joins/">
    <title>
  Database - SQL - Table Joins - Tan Duc Mai
</title>

    <link rel="canonical" href="https://tanducmai.com/posts/database-sql-table-joins/">
    
    <link  rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700">
    <link rel="stylesheet" href="/css/normalize.min.css">
    <link rel="stylesheet" href="/css/style.min.css">

    

    

    <link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

    
      <link rel="alternate" href="https://tanducmai.com/index.xml" type="application/rss+xml" title="Tan Duc Mai">
      <link href="https://tanducmai.com/index.xml" rel="feed" type="application/rss+xml" title="Tan Duc Mai" />
    

    <meta name="generator" content="Hugo 0.68.3" />
  </head>

  <body class="">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">Tan Duc Mai</a>
    <input type="checkbox" id="menu-control"/>
    <label class="menu-mobile  float-right " for="menu-control">
      <span class="btn-mobile  float-right ">&#9776;</span>
      <ul class="navigation-list">
        
          
            <li class="navigation-item  align-center ">
              <a class="navigation-link" href="https://tanducmai.com/about">About</a>
            </li>
          
            <li class="navigation-item  align-center ">
              <a class="navigation-link" href="https://tanducmai.com/posts">Blog</a>
            </li>
          
            <li class="navigation-item  align-center ">
              <a class="navigation-link" href="https://tanducmai.com/projects">Portfolio</a>
            </li>
          
            <li class="navigation-item  align-center ">
              <a class="navigation-link" href="https://tanducmai.com/contact">Contact</a>
            </li>
          
        
        
          
          
          
            <li class= " mobile-menu-lang-separator-centered ">
              <hr />
            </li>
          
          
            
          
            
              
                
                  <li class="multilingual-separator">
                    <p>|</p>
                  </li>
                
                
              
              <li class="navigation-item  align-center ">
                <a href="https://tanducmai.com/ja/">Japanese</a>
              </li>
            
          
        
      </ul>
    </label>
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
  <article>
    <header>
      <h1 class="title">Database - SQL - Table Joins</h1>
      <h2 class="date">March 15, 2022</h2>

      
    </header>

    <h3 id="table-of-contents">Table Of Contents</h3>
<ol>
<li><a href="#join-keyword">JOIN Keyword</a></li>
<li><a href="#table-aliases">Table Aliases</a></li>
<li><a href="#inner-join-keyword">INNER JOIN Keyword</a></li>
<li><a href="#duplicate-column-names">Duplicate Column Names</a></li>
<li><a href="#multiple-attributes-in-a-join-condition">Multiple Attributes in a Join
Condition</a></li>
<li><a href="#outer-join-keyword">OUTER JOIN Keyword</a></li>
<li><a href="#left-join-keyword">LEFT [OUTER] JOIN Keyword</a></li>
<li><a href="#right-join-keyword">RIGHT [OUTER] JOIN Keyword</a></li>
<li><a href="#full-join-keyword">FULL [OUTER] JOIN Keyword</a></li>
<li><a href="#summary-of-join">Summary of JOIN</a></li>
</ol>
<p><img src="/images/database-sql-table-joins/summary.png" alt="Summary JOIN"></p>
<h3 id="join-keyword"><code>JOIN</code> keyword</h3>
<p>Tables (relations) can be combined to form a new relation using the JOIN keyword.</p>
<p>This relation can have a combination of the attributes from the tables
used in the query.</p>
<p>Syntax:</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="o">&lt;</span><span class="n">selectList</span><span class="o">&gt;</span> <span class="k">FROM</span> <span class="n">TableA</span> <span class="k">JOIN</span> <span class="n">TableB</span>
<span class="k">ON</span> <span class="n">TableA</span><span class="p">.</span><span class="k">key</span> <span class="o">=</span> <span class="n">TableB</span><span class="p">.</span><span class="k">key</span><span class="p">;</span>
</code></pre></div><p>For example:</p>
<p><strong>TableA</strong></p>
<table>
<thead>
<tr>
<th>studentID</th>
<th>name</th>
<th>addID</th>
</tr>
</thead>
<tbody>
<tr>
<td>001</td>
<td>Henry</td>
<td>a1</td>
</tr>
<tr>
<td>002</td>
<td>Duc</td>
<td>a2</td>
</tr>
</tbody>
</table>
<p><strong>TableB</strong></p>
<table>
<thead>
<tr>
<th>addID</th>
<th>postcode</th>
</tr>
</thead>
<tbody>
<tr>
<td>a1</td>
<td>5000</td>
</tr>
<tr>
<td>a2</td>
<td>5010</td>
</tr>
</tbody>
</table>
<p>Combine TableA and TableB produces TableC.</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">TableA</span> <span class="k">JOIN</span> <span class="n">TableB</span> <span class="k">ON</span> <span class="n">TableA</span><span class="p">.</span><span class="n">addID</span> <span class="o">=</span> <span class="n">TableB</span><span class="p">.</span><span class="n">addID</span>
</code></pre></div><p><strong>TableC</strong> (result)</p>
<table>
<thead>
<tr>
<th>studentID</th>
<th>name</th>
<th>addID</th>
<th>addID</th>
<th>postcode</th>
</tr>
</thead>
<tbody>
<tr>
<td>001</td>
<td>Henry</td>
<td>a1</td>
<td>a1</td>
<td>5000</td>
</tr>
<tr>
<td>001</td>
<td>Duc</td>
<td>a2</td>
<td>a2</td>
<td>5010</td>
</tr>
</tbody>
</table>
<h5 id="joined-attributes">Joined attributes</h5>
<p>To re-create the information captured in the data, relations must be
merged together based on conditions that specify which attributes in one
relation match the same data in the attributes of the other relation.</p>
<p>This ordinarily follows the rule: TableB(FK) ~&gt; TableA(PK) attributes.</p>
<p>In the above database design:</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="n">TableA</span><span class="p">.</span><span class="n">addID</span> <span class="o">=</span> <span class="n">TableB</span><span class="p">.</span><span class="n">addID</span>
</code></pre></div><p>The addID attribute of TableA and the addID attribute of TableB are
called the <strong>joined attributes</strong>.</p>
<h3 id="table-aliases">Table Aliases</h3>
<p>When querying, you may want to improve the readability of the JOIN
queries by renaming your relations with an alias.</p>
<p>It is useful where the relation is used more than once to distinguish
between different instances of the relation.</p>
<p>For example, given the following relational schemas:</p>
<div class="highlight"><pre class="chroma"><code class="language-text" data-lang="text">Department(deptName, address, city)
PK(deptName)

Employee(firstName, lastName, dept, office, salary, city)
PK(firstName, lastName)
FK(dept) -&gt; Department(deptName)
</code></pre></div><p>Bad design:</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="n">Employee</span><span class="p">.</span><span class="n">firstName</span><span class="p">,</span> <span class="n">Department</span><span class="p">.</span><span class="n">city</span>
<span class="k">FROM</span> <span class="n">Department</span> <span class="k">JOIN</span> <span class="n">Employee</span>
<span class="k">ON</span> <span class="n">Department</span><span class="p">.</span><span class="n">deptName</span> <span class="o">=</span> <span class="n">Employee</span><span class="p">.</span><span class="n">dept</span>
<span class="k">WHERE</span> <span class="n">lastName</span> <span class="o">=</span> <span class="s1">&#39;Brown&#39;</span><span class="p">;</span>
</code></pre></div><p>Better design:</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="n">E</span><span class="p">.</span><span class="n">firstName</span><span class="p">,</span> <span class="n">D</span><span class="p">.</span><span class="n">city</span>
<span class="k">FROM</span> <span class="n">Department</span> <span class="k">AS</span> <span class="n">D</span> <span class="k">JOIN</span> <span class="n">Employee</span> <span class="k">AS</span> <span class="n">E</span>
<span class="k">ON</span> <span class="n">D</span><span class="p">.</span><span class="n">deptName</span> <span class="o">=</span> <span class="n">E</span><span class="p">.</span><span class="n">dept</span>
<span class="k">WHERE</span> <span class="n">lastName</span> <span class="o">=</span> <span class="s1">&#39;Brown&#39;</span><span class="p">;</span>
</code></pre></div><h3 id="inner-join-keyword">INNER JOIN keyword</h3>
<p>The type of joining two relations we have been discussing so far is the
same as using the INNER JOIN keyword.</p>
<ul>
<li>Only returns connected, matching tuples from both relations.</li>
</ul>
<p>For an explanation of why it is called an INNER JOIN, refer to the
following algorithm:</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">for</span> <span class="k">each</span> <span class="n">employee</span> <span class="n">x</span> <span class="k">in</span> <span class="n">Employee</span>
    <span class="k">for</span> <span class="k">each</span> <span class="n">department</span> <span class="n">y</span> <span class="k">in</span> <span class="n">Department</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">.</span><span class="n">dept</span> <span class="o">==</span> <span class="n">y</span><span class="p">.</span><span class="n">deptname</span> <span class="k">then</span>
            <span class="k">output</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="n">tuple</span>
        <span class="k">end</span> <span class="k">if</span>
    <span class="k">end</span> <span class="k">for</span> <span class="n">y</span>
<span class="k">end</span> <span class="k">for</span> <span class="n">x</span>
</code></pre></div><p>If an employee&rsquo;s tuple does not match any department&rsquo;s tuple in a join,
the employee&rsquo;s tuple is said to be <em>dangling</em> and thus dropped from the
output.</p>
<p>The following sql statements have the same semantic and output:</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Department</span><span class="p">,</span> <span class="n">Employee</span> <span class="k">WHERE</span> <span class="n">Employee</span><span class="p">.</span><span class="n">dept</span> <span class="o">=</span> <span class="n">Department</span><span class="p">.</span><span class="n">deptName</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Department</span> <span class="k">JOIN</span> <span class="n">Employee</span> <span class="k">ON</span> <span class="n">Employee</span><span class="p">.</span><span class="n">dept</span> <span class="o">=</span> <span class="n">Department</span><span class="p">.</span><span class="n">deptName</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">Department</span> <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">Employee</span> <span class="k">ON</span> <span class="n">Employee</span><span class="p">.</span><span class="n">dept</span> <span class="o">=</span> <span class="n">Department</span><span class="p">.</span><span class="n">deptName</span>
</code></pre></div><h3 id="duplicate-column-names">Duplicate column names</h3>
<p>Using the same relational database as above, for each employee with
lastName Brown, list their firstName, the city where they live and the
city in which they work.</p>
<ul>
<li>Use the table&rsquo;s name to distinguish duplicate column names.</li>
</ul>
<p>Incorrect query (ambiguous column name):</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="n">firstName</span><span class="p">,</span> <span class="n">city</span><span class="p">,</span> <span class="n">city</span>
<span class="k">FROM</span> <span class="n">Department</span> <span class="k">AS</span> <span class="n">D</span> <span class="k">JOIN</span> <span class="n">Employee</span> <span class="k">AS</span> <span class="n">E</span> <span class="k">ON</span> <span class="n">deptName</span> <span class="o">=</span> <span class="n">dept</span>
<span class="k">WHERE</span> <span class="n">lastName</span> <span class="o">=</span> <span class="s1">&#39;Brown&#39;</span><span class="p">;</span>
</code></pre></div><p>Correct query:</p>
<div class="highlight"><pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="n">firstName</span><span class="p">,</span> <span class="n">E</span><span class="p">.</span><span class="n">city</span><span class="p">,</span> <span class="n">D</span><span class="p">.</span><span class="n">city</span>
<span class="k">FROM</span> <span class="n">Department</span> <span class="k">AS</span> <span class="n">D</span> <span class="k">JOIN</span> <span class="n">Employee</span> <span class="k">AS</span> <span class="n">E</span> <span class="k">ON</span> <span class="n">deptName</span> <span class="o">=</span> <span class="n">dept</span>
<span class="k">WHERE</span> <span class="n">lastName</span> <span class="o">=</span> <span class="s1">&#39;Brown&#39;</span><span class="p">;</span>
</code></pre></div><p>Note that &ldquo;firstName&rdquo; is unambiguous hence it does not need to be
qualified with the table from which it comes from.</p>
<h3 id="multiple-attributes-in-a-join-condition">Multiple attributes in a join condition</h3>
<p><img src="/images/database-sql-table-joins/multi-attributes.png" alt="INNER JOIN keyword"></p>
<h3 id="outer-join-keyword"><code>OUTER JOIN</code> keyword</h3>
<p>This keyword is a variant of the JOIN keyword that keeps the <em>dangling</em>
tuples in the result.</p>
<p>It is achieved by
<a href="https://www.oxfordlearnersdictionaries.com/definition/english/pad_2">padding</a>
missing values with NULL where the tuples is <em>dangling</em> (do not match in
both relations).</p>
<h5 id="join--inner-join"><code>JOIN</code> | <code>INNER JOIN</code></h5>
<p><img src="/images/database-sql-table-joins/inner-join.png" alt="INNER JOIN keyword"></p>
<p>There are three variants of the OUTER JOIN keyword:</p>
<h3 id="left-join-keyword"><code>LEFT JOIN</code> keyword</h3>
<p>Only dangling tuples of the <strong>left</strong> of the JOIN keyword are padded with
NULL values.</p>
<ul>
<li><code>LEFT JOIN </code> | <code>LEFT OUTER JOIN</code></li>
<li>Returns all connected and unconnected tuples from the left relation
(NULLs in right).</li>
</ul>
<p><img src="/images/database-sql-table-joins/left-join.png" alt="LEFT JOIN keyword"></p>
<h3 id="right-join-keyword"><code>RIGHT JOIN</code> keyword</h3>
<p>Only dangling tuples of the <strong>right</strong> of the JOIN keyword are padded
with NULL values.</p>
<ul>
<li><code>RIGHT JOIN </code> | <code>RIGHT OUTER JOIN</code></li>
<li>Returns all connected and unconnected tuples from the right relation
(NULLs in left).</li>
</ul>
<p><img src="/images/database-sql-table-joins/right-join.png" alt="RIGHT JOIN keyword"></p>
<h3 id="full-join-keyword"><code>FULL JOIN</code> keyword</h3>
<p>Dangling tuples of <strong>both sides</strong> of the JOIN keyword are padded with
NULL values.</p>
<ul>
<li><code>FULL JOIN </code> | <code>FULL OUTER JOIN</code></li>
<li>Returns all connected and unconnected tuples from the both left and
right relation.</li>
</ul>
<p><img src="/images/database-sql-table-joins/full-join.png" alt="FULL JOIN keyword"></p>
<h3 id="summary-of-join">Summary of JOIN</h3>
<p>All of the JOIN keyword variants can be summarised as:</p>
<p><img src="/images/database-sql-table-joins/summary.png" alt="Summary JOIN"></p>
<p>Credit: C.L. Moffatt (2008)</p>

  </article>

  <br/>

  
      <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "tan-duc-mai" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  
  
</section>

      </div>
      
    </main>

    

  <script src="/js/app.js"></script>
  
  </body>
</html>
